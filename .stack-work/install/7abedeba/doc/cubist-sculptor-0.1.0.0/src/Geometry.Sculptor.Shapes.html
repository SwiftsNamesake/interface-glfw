<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |</span><span>
</span><a name="line-2"></a><span class="hs-comment">-- Module      : Geometry.Sculptor.Shapes</span><span>
</span><a name="line-3"></a><span class="hs-comment">-- Description :</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- Copyright   : (c) Jonatan H Sundqvist, 2015</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- License     : MIT</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- Maintainer  : Jonatan H Sundqvist</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- Stability   :</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- Portability : Portable</span><span>
</span><a name="line-9"></a><span class="hs-comment">--</span><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-comment">-- Based on Graphics.Michelangelo.Shapes</span><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span class="hs-comment">-- TODO | - Generic container types (eg. Monoids or OverloadedLists?)</span><span>
</span><a name="line-14"></a><span class="hs-comment">--          -- Rely on polymorphism (typeclasses) rather than hard-coded types</span><span>
</span><a name="line-15"></a><span class="hs-comment">--        - Generic vertex types (?)</span><span>
</span><a name="line-16"></a><span class="hs-comment">--        - Anchored shapes (?)</span><span>
</span><a name="line-17"></a><span class="hs-comment">--        - Bounding boxes</span><span>
</span><a name="line-18"></a><span class="hs-comment">--        - Indexed shapes</span><span>
</span><a name="line-19"></a><span class="hs-comment">--        - Triangulation (or - more generally - tiling) of polygons</span><span>
</span><a name="line-20"></a><span class="hs-comment">--        - QuickCheck</span><span>
</span><a name="line-21"></a><span class="hs-comment">--        - Performance</span><span>
</span><a name="line-22"></a><span class="hs-comment">--        - Types to represent surfaces, edges, etc.</span><span>
</span><a name="line-23"></a><span class="hs-comment">--        - Different coordinate systems and orientations (eg. clockwise vs counter-clockwise)</span><span>
</span><a name="line-24"></a><span class="hs-comment">--        - Generating colours (eg. monochrome) and creating data that is easily uploaded to the GPU</span><span>
</span><a name="line-25"></a><span class="hs-comment">--</span><span>
</span><a name="line-26"></a><span class="hs-comment">--        - Use types to ensure correctness</span><span>
</span><a name="line-27"></a><span class="hs-comment">--          -- Color type (and a module to go with it)</span><span>
</span><a name="line-28"></a><span class="hs-comment">--          -- Vector type (cf. Cartesian)</span><span>
</span><a name="line-29"></a><span class="hs-comment">--          -- Vertex winding</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-comment">-- SPEC | -</span><span>
</span><a name="line-32"></a><span class="hs-comment">--        -</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Geometry</span><span class="hs-operator">.</span><span class="hs-identifier">Sculptor</span><span class="hs-operator">.</span><span class="hs-identifier">Shapes</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-comment">--------------------------------------------------------------------------------------------------------------------------------------------</span><span>
</span><a name="line-41"></a><span class="hs-comment">-- We'll need these</span><span>
</span><a name="line-42"></a><span class="hs-comment">--------------------------------------------------------------------------------------------------------------------------------------------</span><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Leibniz</span><span class="hs-operator">.</span><span class="hs-identifier">Constants</span><span> </span><span class="hs-special">(</span><span class="">&#164;</span><span class="hs-identifier">&#199;</span><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-comment">--------------------------------------------------------------------------------------------------------------------------------------------</span><span>
</span><a name="line-48"></a><span class="hs-comment">-- Types</span><span>
</span><a name="line-49"></a><span class="hs-comment">--------------------------------------------------------------------------------------------------------------------------------------------</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-comment">-- | A 'Face' is a list of vertices</span><span>
</span><a name="line-52"></a><span class="hs-comment">-- TODO: Polymorphic container</span><span>
</span><a name="line-53"></a><span class="hs-comment">-- TODO: Make sure all vertices lie in the same plane (using Triangles?)</span><span>
</span><a name="line-54"></a><span class="hs-keyword">data</span><span> </span><a name="Face"><a href="Geometry.Sculptor.Shapes.html#Face"><span class="hs-identifier">Face</span></a></a><span> </span><a name="local-6989586621679035680"><a href="#local-6989586621679035680"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Face"><a href="Geometry.Sculptor.Shapes.html#Face"><span class="hs-identifier">Face</span></a></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679035680"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">]</span><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-58"></a><span class="hs-keyword">data</span><span> </span><a name="Edge"><a href="Geometry.Sculptor.Shapes.html#Edge"><span class="hs-identifier">Edge</span></a></a><span> </span><a name="local-6989586621679035679"><a href="#local-6989586621679035679"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Edge"><a href="Geometry.Sculptor.Shapes.html#Edge"><span class="hs-identifier">Edge</span></a></a><span> </span><a href="#local-6989586621679035679"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679035679"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-comment">--------------------------------------------------------------------------------------------------------------------------------------------</span><span>
</span><a name="line-63"></a><span class="hs-comment">-- Data</span><span>
</span><a name="line-64"></a><span class="hs-comment">--------------------------------------------------------------------------------------------------------------------------------------------</span><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span class="hs-comment">--------------------------------------------------------------------------------------------------------------------------------------------</span><span>
</span><a name="line-69"></a><span class="hs-comment">-- Functions</span><span>
</span><a name="line-70"></a><span class="hs-comment">--------------------------------------------------------------------------------------------------------------------------------------------</span><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-comment">-- Vertex constructors ---------------------------------------------------------------------------------------------------------------------</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-comment">-- | A simple list of vertices</span><span>
</span><a name="line-75"></a><span class="hs-identifier">vlist</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679036264"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036264"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036264"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679036264"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-76"></a><a name="vlist"><a href="Geometry.Sculptor.Shapes.html#vlist"><span class="hs-identifier">vlist</span></a></a><span> </span><a name="local-6989586621679036265"><a href="#local-6989586621679036265"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679036266"><a href="#local-6989586621679036266"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679036267"><a href="#local-6989586621679036267"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679036265"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679036266"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679036267"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">]</span><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-comment">-- Tessellation ----------------------------------------------------------------------------------------------------------------------------</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-comment">-- TODO: Move tessellation to separate module</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-comment">-- | Tessellate a polygon with triangles. Presently, only concave shapes will tessellate properly.</span><span>
</span><a name="line-83"></a><span class="hs-comment">-- TODO: Make it work for any shape (convex and concave)</span><span>
</span><a name="line-84"></a><span class="hs-comment">-- TODO: Opposite rather than adjacent sides (don't include centre)</span><span>
</span><a name="line-85"></a><span class="hs-identifier">triangles</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679036263"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679036263"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-86"></a><a name="triangles"><a href="Geometry.Sculptor.Shapes.html#triangles"><span class="hs-identifier">triangles</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679036268"><a href="#local-6989586621679036268"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679036269"><a href="#local-6989586621679036269"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036711"><span class="hs-identifier hs-var">pairwise</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679036911"><a href="#local-6989586621679036911"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679036912"><a href="#local-6989586621679036912"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679036268"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679036911"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679036912"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679036269"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-87"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-88"></a><span>    </span><span class="hs-comment">-- | Combine every adjacent pair in the list with the given function</span><span>
</span><a name="line-89"></a><span>    </span><span class="hs-identifier">pairwise</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036712"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036712"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036713"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679036712"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679036713"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-90"></a><span>    </span><a name="local-6989586621679036711"><a href="#local-6989586621679036711"><span class="hs-identifier">pairwise</span></a></a><span> </span><a name="local-6989586621679036714"><a href="#local-6989586621679036714"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679036715"><a href="#local-6989586621679036715"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span> </span><a href="#local-6989586621679036714"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679036715"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679036715"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span class="hs-comment">-- Two-dimensional shapes ------------------------------------------------------------------------------------------------------------------</span><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span class="hs-comment">-- TODO: Normals and texture coordinates</span><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span class="hs-comment">-- | Create a point that lies on the XY plane</span><span>
</span><a name="line-97"></a><span class="hs-identifier">xy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679036261"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036261"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036261"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036261"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036262"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036261"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036261"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036262"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-98"></a><a name="xy"><a href="Geometry.Sculptor.Shapes.html#xy"><span class="hs-identifier">xy</span></a></a><span> </span><a name="local-6989586621679036913"><a href="#local-6989586621679036913"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679036914"><a href="#local-6989586621679036914"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679036915"><a href="#local-6989586621679036915"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036913"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679036914"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679036915"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span class="hs-comment">-- | Create a point that lies on the XZ plane</span><span>
</span><a name="line-102"></a><span class="hs-identifier">xz</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679036259"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036259"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036259"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036259"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036260"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036259"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036259"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036260"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-103"></a><a name="xz"><a href="Geometry.Sculptor.Shapes.html#xz"><span class="hs-identifier">xz</span></a></a><span> </span><a name="local-6989586621679036916"><a href="#local-6989586621679036916"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679036917"><a href="#local-6989586621679036917"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679036918"><a href="#local-6989586621679036918"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036916"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679036917"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679036918"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-comment">-- | Create a point that lies on the YZ plane</span><span>
</span><a name="line-107"></a><span class="hs-identifier">yz</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679036257"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036257"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036257"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036257"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036258"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036257"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036257"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036258"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-108"></a><a name="yz"><a href="Geometry.Sculptor.Shapes.html#yz"><span class="hs-identifier">yz</span></a></a><span> </span><a name="local-6989586621679036919"><a href="#local-6989586621679036919"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679036920"><a href="#local-6989586621679036920"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679036921"><a href="#local-6989586621679036921"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679036919"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679036921"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679036920"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-comment">-- | Generate the vertices for a rectangular plane, centred at (0,0,0)</span><span>
</span><a name="line-112"></a><span class="hs-comment">--   TODO: Rename (eg. 'rectangle') (?)</span><span>
</span><a name="line-113"></a><span class="hs-comment">--</span><span>
</span><a name="line-114"></a><span class="hs-comment">--   Assuming the plane is parallel to the X and Y axes, the vertices are given in a clockwise order,</span><span>
</span><a name="line-115"></a><span class="hs-comment">--   starting from the top left corner (eg. top left, top right, bottom right, bottom left).</span><span>
</span><a name="line-116"></a><span class="hs-identifier">plane</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679036255"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036255"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036255"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036256"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036255"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036255"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679036256"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-117"></a><a name="plane"><a href="Geometry.Sculptor.Shapes.html#plane"><span class="hs-identifier">plane</span></a></a><span> </span><a name="local-6989586621679036922"><a href="#local-6989586621679036922"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679036923"><a href="#local-6989586621679036923"><span class="hs-identifier">da</span></a></a><span> </span><a name="local-6989586621679036924"><a href="#local-6989586621679036924"><span class="hs-identifier">db</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679036922"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679036923"><span class="hs-identifier hs-var">da</span></a><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036924"><span class="hs-identifier hs-var">db</span></a><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679036922"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036923"><span class="hs-identifier hs-var">da</span></a><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036924"><span class="hs-identifier hs-var">db</span></a><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679036922"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036923"><span class="hs-identifier hs-var">da</span></a><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679036924"><span class="hs-identifier hs-var">db</span></a><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679036922"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679036923"><span class="hs-identifier hs-var">da</span></a><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679036924"><span class="hs-identifier hs-var">db</span></a><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span class="hs-comment">-- TODO: Deal with clock-wise/counter-clockwise issues (if there are any)</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-comment">-- | Generate the vertices for a rectangular plane, parallel with the X and Y axes and centred at (0,0,0)</span><span>
</span><a name="line-122"></a><span class="hs-identifier">planeXY</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679036253"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036253"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036253"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036253"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036254"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036253"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036253"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679036254"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-123"></a><a name="planeXY"><a href="Geometry.Sculptor.Shapes.html#planeXY"><span class="hs-identifier">planeXY</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Geometry.Sculptor.Shapes.html#plane"><span class="hs-identifier hs-var">plane</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Geometry.Sculptor.Shapes.html#xy"><span class="hs-identifier hs-var">xy</span></a><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-comment">-- | Generate the vertices for a rectangular plane, parallel with the X and Z axes and centred at (0,0,0)</span><span>
</span><a name="line-127"></a><span class="hs-identifier">planeXZ</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679036251"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036251"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036251"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036251"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036252"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036251"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036251"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679036252"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-128"></a><a name="planeXZ"><a href="Geometry.Sculptor.Shapes.html#planeXZ"><span class="hs-identifier">planeXZ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Geometry.Sculptor.Shapes.html#plane"><span class="hs-identifier hs-var">plane</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Geometry.Sculptor.Shapes.html#xz"><span class="hs-identifier hs-var">xz</span></a><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-comment">-- | Generate the vertices for a rectangular plane, parallel with the Y and Z axes and centred at (0,0,0)</span><span>
</span><a name="line-132"></a><span class="hs-identifier">planeYZ</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679036249"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036249"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036249"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036249"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036250"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036249"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036249"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679036250"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-133"></a><a name="planeYZ"><a href="Geometry.Sculptor.Shapes.html#planeYZ"><span class="hs-identifier">planeYZ</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Geometry.Sculptor.Shapes.html#plane"><span class="hs-identifier hs-var">plane</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Geometry.Sculptor.Shapes.html#yz"><span class="hs-identifier hs-var">yz</span></a><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-comment">-- | Generate the vertices for a regular polygon, centred at (0,0,0)</span><span>
</span><a name="line-137"></a><span class="hs-identifier">polygon</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Floating</span><span> </span><a href="#local-6989586621679036246"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679036247"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036246"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036246"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036248"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036247"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036246"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679036248"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-138"></a><a name="polygon"><a href="Geometry.Sculptor.Shapes.html#polygon"><span class="hs-identifier">polygon</span></a></a><span> </span><a name="local-6989586621679036925"><a href="#local-6989586621679036925"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679036926"><a href="#local-6989586621679036926"><span class="hs-identifier">sides</span></a></a><span> </span><a name="local-6989586621679036927"><a href="#local-6989586621679036927"><span class="hs-identifier">radius</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="">&#9580;&#169;</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-number">2</span><span class="">*&#164;</span><span class="hs-identifier hs-var">&#199;</span><span class="hs-operator hs-var">/</span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier">sides</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">radius</span><span class="hs-operator hs-var">*</span><span class="hs-identifier">cos</span><span> </span><span class="">&#9580;&#169;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">radius</span><span class="hs-operator hs-var">*</span><span class="hs-identifier">sin</span><span> </span><span class="">&#9580;&#169;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="hs-identifier">sides</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-142"></a><span class="hs-comment">-- lattice :: </span><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-comment">-- Three-dimensional shapes ----------------------------------------------------------------------------------------------------------------</span><span>
</span><a name="line-145"></a><span>
</span><a name="line-146"></a><span class="hs-comment">-- | Generate the vertices of an axis-aligned cuboid centred at (0,0,0)</span><span>
</span><a name="line-147"></a><span class="hs-comment">-- TODO: Use combinatorics to generate vertices (?)</span><span>
</span><a name="line-148"></a><span class="hs-comment">-- TODO: Specify order and winding somehow</span><span>
</span><a name="line-149"></a><span class="hs-identifier">cuboid</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679036244"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036244"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036244"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036244"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036245"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036244"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036244"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036244"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679036245"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-150"></a><a name="cuboid"><a href="Geometry.Sculptor.Shapes.html#cuboid"><span class="hs-identifier">cuboid</span></a></a><span> </span><a name="local-6989586621679036994"><a href="#local-6989586621679036994"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679036995"><a href="#local-6989586621679036995"><span class="hs-identifier">dx</span></a></a><span> </span><a name="local-6989586621679036996"><a href="#local-6989586621679036996"><span class="hs-identifier">dy</span></a></a><span> </span><a name="local-6989586621679036997"><a href="#local-6989586621679036997"><span class="hs-identifier">dz</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679036994"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679036998"><span class="hs-identifier hs-var">hdx</span></a><span class="hs-special">)</span><span>   </span><a href="#local-6989586621679036999"><span class="hs-identifier hs-var">hdy</span></a><span>  </span><a href="#local-6989586621679037000"><span class="hs-identifier hs-var">hdz</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679036994"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679036998"><span class="hs-identifier hs-var">hdx</span></a><span>   </span><a href="#local-6989586621679036999"><span class="hs-identifier hs-var">hdy</span></a><span>  </span><a href="#local-6989586621679037000"><span class="hs-identifier hs-var">hdz</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679036994"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679036998"><span class="hs-identifier hs-var">hdx</span></a><span>   </span><a href="#local-6989586621679036999"><span class="hs-identifier hs-var">hdy</span></a><span>  </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679037000"><span class="hs-identifier hs-var">hdz</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679036994"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679036998"><span class="hs-identifier hs-var">hdx</span></a><span class="hs-special">)</span><span>   </span><a href="#local-6989586621679036999"><span class="hs-identifier hs-var">hdy</span></a><span>  </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679037000"><span class="hs-identifier hs-var">hdz</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-comment">--</span><span>
</span><a name="line-151"></a><span>                     </span><a href="#local-6989586621679036994"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679036998"><span class="hs-identifier hs-var">hdx</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679036999"><span class="hs-identifier hs-var">hdy</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679037000"><span class="hs-identifier hs-var">hdz</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679036994"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679036998"><span class="hs-identifier hs-var">hdx</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679036999"><span class="hs-identifier hs-var">hdy</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679037000"><span class="hs-identifier hs-var">hdz</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679036994"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679036998"><span class="hs-identifier hs-var">hdx</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679036999"><span class="hs-identifier hs-var">hdy</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679037000"><span class="hs-identifier hs-var">hdz</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679036994"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679036998"><span class="hs-identifier hs-var">hdx</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679036999"><span class="hs-identifier hs-var">hdy</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><a href="#local-6989586621679037000"><span class="hs-identifier hs-var">hdz</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">--</span><span>
</span><a name="line-152"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-153"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679036998"><a href="#local-6989586621679036998"><span class="hs-identifier">hdx</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679036999"><a href="#local-6989586621679036999"><span class="hs-identifier">hdy</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679037000"><a href="#local-6989586621679037000"><span class="hs-identifier">hdz</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036995"><span class="hs-identifier hs-var">dx</span></a><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679036996"><span class="hs-identifier hs-var">dy</span></a><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679036997"><span class="hs-identifier hs-var">dz</span></a><span class="hs-operator hs-var">/</span><span class="hs-number">2</span><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span>
</span><a name="line-155"></a><span>
</span><a name="line-156"></a><span class="hs-comment">-- | Generate the vertices of an axis-aligned cube centred at (0,0,0)</span><span>
</span><a name="line-157"></a><span class="hs-identifier">cube</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679036242"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679036242"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036242"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036242"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036243"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679036242"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679036243"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-158"></a><a name="cube"><a href="Geometry.Sculptor.Shapes.html#cube"><span class="hs-identifier">cube</span></a></a><span> </span><a name="local-6989586621679037001"><a href="#local-6989586621679037001"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679037002"><a href="#local-6989586621679037002"><span class="hs-identifier">side</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Geometry.Sculptor.Shapes.html#cuboid"><span class="hs-identifier hs-var">cuboid</span></a><span> </span><a href="#local-6989586621679037001"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679037002"><span class="hs-identifier hs-var">side</span></a><span> </span><a href="#local-6989586621679037002"><span class="hs-identifier hs-var">side</span></a><span> </span><a href="#local-6989586621679037002"><span class="hs-identifier hs-var">side</span></a><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-comment">-- Indices ---------------------------------------------------------------------------------------------------------------------------------</span><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-163"></a><span class="hs-comment">-- left, right, bottom, top, back, front</span><span>
</span><a name="line-164"></a><span class="hs-comment">-- V3 top left bottom</span><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><span>
</span><a name="line-167"></a><span class="hs-comment">-- | Indices for a solid cuboid (with triangulated sides, cf. `cuboid`)</span><span>
</span><a name="line-168"></a><span class="hs-comment">-- TODO: Use more sensible container types (three levels of lists seems a bit excessive...)</span><span>
</span><a name="line-169"></a><span class="hs-comment">-- TODO: Allow any kind of tessellation (?)</span><span>
</span><a name="line-170"></a><span class="hs-identifier">cuboidIndices</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679036241"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679036241"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-171"></a><a name="cuboidIndices"><a href="Geometry.Sculptor.Shapes.html#cuboidIndices"><span class="hs-identifier">cuboidIndices</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Geometry.Sculptor.Shapes.html#triangles"><span class="hs-identifier hs-var">triangles</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">2</span><span class="hs-special">,</span><span class="hs-number">3</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-number">4</span><span class="hs-special">,</span><span class="hs-number">5</span><span class="hs-special">,</span><span class="hs-number">6</span><span class="hs-special">,</span><span class="hs-number">7</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-number">3</span><span class="hs-special">,</span><span class="hs-number">2</span><span class="hs-special">,</span><span class="hs-number">6</span><span class="hs-special">,</span><span class="hs-number">7</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">5</span><span class="hs-special">,</span><span class="hs-number">4</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">3</span><span class="hs-special">,</span><span class="hs-number">7</span><span class="hs-special">,</span><span class="hs-number">4</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-special">,</span><span class="hs-number">2</span><span class="hs-special">,</span><span class="hs-number">6</span><span class="hs-special">,</span><span class="hs-number">5</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Top, bottom, Front, Back, Left, Right</span><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span>
</span><a name="line-174"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-175"></a><span class="hs-identifier">cuboidLineIndices</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679035681"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679035681"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679035681"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-176"></a><a name="cuboidLineIndices"><a href="Geometry.Sculptor.Shapes.html#cuboidLineIndices"><span class="hs-identifier">cuboidLineIndices</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-special">,</span><span class="hs-number">3</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">4</span><span class="hs-special">,</span><span class="hs-number">5</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">6</span><span class="hs-special">,</span><span class="hs-number">7</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- X-axis</span><span>
</span><a name="line-177"></a><span>                     </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">4</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">5</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">3</span><span class="hs-special">,</span><span class="hs-number">7</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">6</span><span class="hs-special">,</span><span class="hs-number">2</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- Y-axis</span><span>
</span><a name="line-178"></a><span>                     </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span class="hs-number">3</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">2</span><span class="hs-special">,</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">4</span><span class="hs-special">,</span><span class="hs-number">7</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-number">6</span><span class="hs-special">,</span><span class="hs-number">5</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Z-axis</span><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span class="hs-comment">--------------------------------------------------------------------------------------------------------------------------------------------</span><span>
</span><a name="line-181"></a><span>
</span><a name="line-182"></a><span class="hs-comment">-- | Indices for a shape extruded from a 2D polygon</span><span>
</span><a name="line-183"></a><span class="hs-comment">-- TODO: Figure out which types to use</span><span>
</span><a name="line-184"></a><span class="hs-comment">-- TODO: Generic 'stitching' of lid and bottom, counter-clockwise or clockwise (?)</span><span>
</span><a name="line-185"></a><span class="hs-comment">-- TODO: Generate vertices and indices separately</span><span>
</span><a name="line-186"></a><span class="hs-comment">-- extrude :: (Vector v, Fractional f) =&gt; (v -&gt; v') -&gt; v -&gt; [v] -&gt; [v']</span><span>
</span><a name="line-187"></a><span class="hs-comment">-- extrude :: (Num v, Fractional f) =&gt; (v -&gt; v') -&gt; v -&gt; [v] -&gt; [v']</span><span>
</span><a name="line-188"></a><span class="hs-comment">-- extrude f direction shape = undefined</span><span>
</span><a name="line-189"></a><span class="hs-comment">--   where</span><span>
</span><a name="line-190"></a><span class="hs-comment">--     -- |</span><span>
</span><a name="line-191"></a><span class="hs-comment">--     -- side ::</span><span>
</span><a name="line-192"></a><span class="hs-comment">--     side a b = concat [[f a, f $ a + direction, f $ b + direction], [f a, f $ b + direction, f b]]</span><span>
</span><a name="line-193"></a><span class="hs-comment">--</span><span>
</span><a name="line-194"></a><span class="hs-comment">--     -- | Stitches together two polygons by successively connecting one edge from each shape with two adjacent triangles.</span><span>
</span><a name="line-195"></a><span class="hs-comment">--     --   The end result is a rim joining the shapes, made out of a triangle strip.</span><span>
</span><a name="line-196"></a><span class="hs-comment">--     -- TODO: Factor out 'looping' (ie. closing the loop)</span><span>
</span><a name="line-197"></a><span class="hs-comment">--     -- Found hole `_pairwise' with type: (v -&gt; v -&gt; [v']) -&gt; [(a1, b)] -&gt; t0 [a]</span><span>
</span><a name="line-198"></a><span class="hs-comment">--     stitch side' bottom lid = concat . pairwise (uncurry side) $ zip (close bottom) (close lid)</span><span>
</span><a name="line-199"></a><span class="hs-comment">--</span><span>
</span><a name="line-200"></a><span class="hs-comment">--     -- |</span><span>
</span><a name="line-201"></a><span class="hs-comment">--     -- TODO: I wonder how many times I've written this function (factor out)</span><span>
</span><a name="line-202"></a><span class="hs-comment">--     pairwise f xs = zipWith f xs (tail xs)</span><span>
</span><a name="line-203"></a><span class="hs-comment">--</span><span>
</span><a name="line-204"></a><span class="hs-comment">--     -- |</span><span>
</span><a name="line-205"></a><span class="hs-comment">--     close shape' = shape' ++ [head shape']</span><span>
</span><a name="line-206"></a><span class="hs-comment">--</span><span>
</span><a name="line-207"></a><span class="hs-comment">--     -- |</span><span>
</span><a name="line-208"></a><span class="hs-comment">--     rim = stitch undefined</span><span>
</span><a name="line-209"></a></pre></body></html>